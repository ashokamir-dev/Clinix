<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Clinic Run — Select Area</title>
  <link rel="manifest" href="manifest.json">
  <style>
    :root{--bg:#f2f5f9;--card:#ffffff;--muted:#6b7280;--blue:#0b69ff;--green:#10b981;--grey:#9ca3af}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:var(--bg);display:flex;flex-direction:column}
    .screen{max-width:480px;margin:0 auto;width:100%;padding:16px;box-sizing:border-box}
    header{display:flex;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:8px 0}
    .big-card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 6px 18px rgba(16,24,40,0.06)}
    .choices{display:flex;gap:10px;justify-content:space-between;margin-top:12px}
    .btn{flex:1;padding:14px;border-radius:10px;border:0;font-weight:600;font-size:16px}
    .btn-choose{background:#eef2ff;color:var(--blue)}
    .parse-area{margin-top:14px}
    textarea{width:100%;min-height:120px;border-radius:10px;padding:12px;border:1px solid #e5e7eb;resize:vertical}
    .row{display:flex;gap:8px;margin-top:10px}
    .primary{background:var(--blue);color:white;padding:12px;border-radius:10px;border:0;flex:1}
    .secondary{background:white;border:1px solid #e5e7eb;padding:12px;border-radius:10px;color:var(--muted)}
    .list{margin-top:14px}
    .card{background:var(--card);padding:12px;border-radius:12px;margin-bottom:10px;display:flex;flex-direction:column;box-shadow:0 4px 10px rgba(2,6,23,0.04)}
    .card .top{display:flex;justify-content:space-between;align-items:center}
    .clinic-title{font-weight:700}
    .clinic-code{color:var(--muted);font-size:13px}
    .controls{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
    .chip{padding:8px 10px;border-radius:8px;border:1px solid #e6e7eb;font-weight:600}
    .chip.blue{background:var(--blue);color:white}
    .chip.green{background:var(--green);color:white}
    .chip.grey{background:var(--grey);color:white}
    .small{font-size:13px;padding:6px 8px}
    .qtys{display:flex;gap:6px;flex-wrap:wrap}
    .qty{width:40px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;border:1px solid #e6e7eb;font-weight:700}
    .qty.selected{background:#111827;color:white}
    .done{background:#d1fae5;color:#065f46;padding:8px;border-radius:8px;border:0}
    .undo{background:#fff3cd;color:#7c2d12;padding:8px;border-radius:8px;border:0}
    footer{position:sticky;bottom:0;padding:12px;background:linear-gradient(0deg,rgba(242,245,249,1),rgba(242,245,249,0));}
    .progress-wrap{display:flex;align-items:center;gap:10px}
    .progress{background:#e6eefb;height:12px;border-radius:10px;flex:1;overflow:hidden}
    .progress > i{background:var(--blue);display:block;height:100%;width:0%}
    .endtrip{margin-top:10px;background:#111827;color:white;padding:12px;border-radius:10px;border:0;width:100%}
    .add-top{display:flex;gap:8px;margin-bottom:8px}
    .add-top input{flex:1;padding:10px;border-radius:8px;border:1px solid #e6e7eb}
    .link{font-size:13px;color:var(--blue);text-decoration:underline;cursor:pointer}
    #login-screen{max-width:480px;margin:20px auto;display:none}
    @media(min-width:520px){body{background:#fff} .screen{box-shadow:0 6px 20px rgba(2,6,23,0.06);border-radius:14px;margin-top:20px}}
  </style>
</head>

<body>
  <!-- LOGIN SCREEN -->
  <div id="login-screen" class="big-card" style="display:none;max-width:480px;margin:20px auto">
    <h1>Clinix Login</h1>
    <input id="login-username" placeholder="Username" style="width:100%;padding:12px;margin-top:10px;border-radius:10px;border:1px solid #ccc"/>
    <input id="login-password" placeholder="Password" type="password" style="width:100%;padding:12px;margin-top:10px;border-radius:10px;border:1px solid #ccc"/>
    <button id="login-btn" class="primary" style="margin-top:15px;width:100%">Login</button>
    <div id="login-error" style="color:red;margin-top:10px;display:none">Invalid username or password</div>
  </div>

  <!-- FULL APP -->
  <div class="screen" id="app" style="display:none">

    <div id="choose-screen" class="big-card">
      <h1>Select area to start</h1>
      <div class="choices">
        <button class="btn btn-choose" data-area="Surrey">Surrey</button>
        <button class="btn btn-choose" data-area="Merton">Merton</button>
        <button class="btn btn-choose" data-area="Cover">Cover</button>
      </div>
      <p style="margin-top:12px;color:var(--muted)">Choose one to continue — this only sets a label for the run.</p>
    </div>

    <div id="cover-start-screen" class="big-card" style="display:none">
      <h1>Start Location</h1>
      <button class="primary" id="cover-gps-btn">Use My GPS Location</button>
      <div style="text-align:center;margin:10px 0;font-size:13px;color:var(--muted)">— OR —</div>
      <input id="cover-address-input" placeholder="Enter starting address (e.g., Streatham, Wimbledon)" style="width:100%;padding:12px;border-radius:10px;border:1px solid #e5e7eb" />
      <div style="display:flex;gap:8px;margin-top:10px">
        <button class="primary" id="cover-address-btn" style="flex:1">Use This Address</button>
        <button class="secondary" id="cover-back-btn">Back</button>
      </div>
    </div>

    <div id="input-screen" class="big-card" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h1 id="area-label">Run</h1>
        <div class="link" id="back-to-choose">Change</div>
      </div>
      <div class="parse-area">
        <textarea id="raw-input" placeholder="Paste the raw text from your notes here..."></textarea>
        <div class="row">
          <button id="parse-btn" class="primary">Parse</button>
          <button id="clear-btn" class="secondary">Clear</button>
        </div>
      </div>
    </div>

    <div id="list-screen" style="display:none">
      <div class="big-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h1>Checklist</h1>
          <div style="font-size:13px;color:var(--muted)" id="run-info">Area</div>
        </div>

        <div style="text-align:right;margin-bottom:10px">
          <span id="logout-btn" style="font-size:13px;color:#dc2626;cursor:pointer">Logout</span>
        </div>

        <div class="add-top">
          <input id="add-code" placeholder="Add clinic code or name" />
          <button id="add-btn" class="chip">Add</button>
        </div>

        <div style="margin-bottom:8px;display:flex;gap:8px;align-items:center">
          <div style="flex:1;background:#fff;padding:8px;border-radius:8px;border:1px solid #e6e7eb">Parsed list</div>
          <div style="font-size:13px;color:var(--muted)">Saved: <span id="saved-ind">—</span></div>
        </div>

        <div class="list" id="checklist"></div>
      </div>

      <footer>
        <div class="progress-wrap">
          <div style="font-size:13px;color:var(--muted)">Progress</div>
          <div class="progress"><i id="progress-bar"></i></div>
          <div style="font-weight:700" id="progress-text">0%</div>
        </div>
      </footer>
    </div>
  </div>

  <script>
    const USERS = {"ashok":"welcome25!","ajant":"happy26!","dhanu":"dhanu25!"};
    let ACTIVE_USER = null;

    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("login-screen").style.display = "block";
      document.getElementById("app").style.display = "none";
    });

    document.getElementById("login-btn").addEventListener("click", () => {
      const username = document.getElementById("login-username").value.trim();
      const password = document.getElementById("login-password").value.trim();

      if (USERS[username] && USERS[username] === password) {
        ACTIVE_USER = username;
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("app").style.display = "block";
      } else {
        document.getElementById("login-error").style.display = "block";
      }
    });
  </script>
</body>
</html>
